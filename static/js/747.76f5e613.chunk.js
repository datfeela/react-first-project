"use strict";(self.webpackChunkfirst_project=self.webpackChunkfirst_project||[]).push([[747],{5747:function(e,n,t){t.r(n),t.d(n,{default:function(){return K}});var r=t(885),a=t(5987),s="Chat_wrap__5o1kl",c="Chat_contentWrap__ZReIg",i=t(4270),u="Header_wrap__mPPRP",o="Header_wrap_dark__fOQUZ",d="Header_goBackButton__DBsF9",l="Header_name__9uURf",g="Header_icon__eZcsh",h="Header_userInfo__RJusU",f="Header_imgLink__OaE9d",_="Header_avatar__R5ZIG",m=t(9029),p=t(3504),v=t(2791),x=t(9067),I=t(184),w=function(e){var n=e.recipientImage,t=e.recipientName,r=e.dialogId,a=(0,v.useContext)(x.I);return(0,I.jsxs)("div",{className:"dark"===a.currentTheme?u+" "+o:u,children:[(0,I.jsxs)(p.OL,{to:"/messages",className:d,children:[(0,I.jsx)(m.O,{className:g,id:"arrowBack"}),(0,I.jsxs)("span",{children:["eng"===a.currentLanguage&&"Go back"," ","ru"===a.currentLanguage&&"\u041d\u0430\u0437\u0430\u0434"]})]}),(0,I.jsx)("div",{className:h,children:(0,I.jsx)(p.OL,{to:"/profile/".concat(r),className:l,children:t})}),(0,I.jsx)(p.OL,{className:f,to:"/profile/".concat(r),children:(0,I.jsx)("img",{src:n,alt:"avatar",className:_})})]})},N=t(1413),b="Messages_wrap__h7bIs",j="Messages_wrap_dark__sc4Lk",M=t(364),y=function(e){switch(e){case"01":return"Jan";case"02":return"Feb";case"03":return"Mar";case"04":return"Apr";case"05":return"May";case"06":return"Jun";case"07":return"Jul";case"08":return"Aug";case"09":return"Sep";case"10":return"Oct";case"11":return"Nov";case"12":return"Dec"}},k={wrap:"Message_wrap__gc5Pe",wrap_notViewed:"Message_wrap_notViewed__spOBk",wrap_sentByUser:"Message_wrap_sentByUser__q17wi",wrap_sentByRecipient:"Message_wrap_sentByRecipient__qJByW",wrap_dark:"Message_wrap_dark__Ukxpv",author:"Message_author__o-jAe",content:"Message_content__rGUGH",avatarWrap:"Message_avatarWrap__Zxl2B",avatar:"Message_avatar__wLnX6",arrivalTime:"Message_arrivalTime__0duye"},C=function(e,n){var t=e.year==(new Date).getFullYear(),r=t&&e.monthNum==(new Date).getMonth()+1&&e.day==(new Date).getDate();return"eng"===n?r?"".concat(e.hour,":").concat(e.minute,":").concat(e.second):t?"".concat(e.month," ").concat(e.day,", ").concat(e.hour,":").concat(e.minute,":").concat(e.second):"".concat(e.month," ").concat(e.day,", ").concat(e.year," ").concat(e.hour,":").concat(e.minute,":").concat(e.second):"ru"===n?r?"".concat(e.hour,":").concat(e.minute,":").concat(e.second):t?"".concat(e.day,".").concat(e.monthNum,", ").concat(e.hour,":").concat(e.minute,":").concat(e.second):"".concat(e.day,".").concat(e.monthNum,".").concat(e.year,", ").concat(e.hour,":").concat(e.minute,":").concat(e.second):void 0},H=(0,M.$j)((function(e){return{authUserId:e.auth.id}}),{})((function(e){var n=(0,v.useContext)(x.I),t="".concat(k.wrap," ").concat(e.authUserId===e.senderId?k.wrap_sentByUser:k.wrap_sentByRecipient," ").concat(e.viewed?"":k.wrap_notViewed," ").concat("dark"===n.currentTheme?k.wrap_dark:""),r=e.authUserId===e.senderId?e.userImage:e.recipientImage,a=function(e){var n=e.slice(0,e.indexOf("T")),t=n.slice(0,n.indexOf("-")),r=n.slice(5,7),a=y(r);n=n.slice(-2);var s=e.slice(e.indexOf("T")+1);return{year:t,monthNum:r,month:a,day:n,fullTime:s.slice(0,s.indexOf(".")),hour:s.slice(0,2),minute:s.slice(3,5),second:s.slice(6,8)}}(e.addedAt),s=C(a,n.currentLanguage);return(0,I.jsxs)("div",{id:e.id,className:t,children:[(0,I.jsx)(p.OL,{to:"/profile/".concat(e.senderId),className:k.avatarWrap,children:(0,I.jsx)("img",{className:k.avatar,src:r,alt:"avatar"})}),(0,I.jsxs)("div",{className:k.content,children:[(0,I.jsx)(p.OL,{to:"/profile/".concat(e.senderId),className:k.author,children:e.senderName}),(0,I.jsx)("div",{dangerouslySetInnerHTML:{__html:e.body}}),(0,I.jsx)("div",{className:k.meta,children:(0,I.jsx)("span",{className:k.arrivalTime,children:s})})]})]})})),Z=t(4786),L=["currentPage","setIsNewMessage","inputHeight","dialogId","getDialog","observerRef","setObserverRef"],O=function(e){e.currentPage;var n=e.setIsNewMessage,t=e.inputHeight,r=e.dialogId,s=e.getDialog,c=e.observerRef,i=e.setObserverRef,u=(0,a.Z)(e,L),o=(0,v.useContext)(x.I);(0,v.useEffect)((function(){!0===u.messages.isNewMessage&&(f(),n(!1))}),[u.messages.isNewMessage]),(0,v.useEffect)((function(){f()}),[]),(0,v.useEffect)((function(){if(h&&h[1]){u.messages.isNewMessage&&null!==c.observer&&c.observer.unobserve(c.target);var e=document.querySelector('[id="'.concat(h[1].key,'"]')),n=(0,Z.H)(d,l);i({observer:n,target:e}),n.observe(e)}}),[u.messages.data]);var d={root:document.querySelector(b)},l=function(){s(r)},g=(0,v.useRef)(),h=u.messages.data.map((function(e){return(0,I.jsx)(H,(0,N.Z)((0,N.Z)({},e),{},{userImage:u.userImage,recipientImage:u.recipientImage}),e.id)})),f=function(){var e=g.current.scrollHeight,n=window.getComputedStyle(g.current).height;n=n.slice(0,n.indexOf("p")),g.current.scrollTop=e-n};return(0,I.jsx)("div",{ref:g,className:"dark"===o.currentTheme?b+" "+j:b,style:{marginBottom:t},children:h})},B="Input_wrap__wn37F",T="Input_wrap_dark__-AchI",U="Input_form__oz+BC",R="Input_button__Ur7gg",A=t(5705),S=t(5689),E=t(4759),D=["dialogId","onInputHeightChange"],P=function(e){return(0,S.sx)(e)},F=function(e){var n=e.dialogId,t=e.onInputHeightChange,r=(0,a.Z)(e,D),s=(0,v.useContext)(x.I),c=(0,v.useRef)(),i=function(){t(window.getComputedStyle(c.current).height)};return(0,I.jsx)("div",{ref:c,className:"dark"===s.currentTheme?B+" "+T:B,children:(0,I.jsx)(A.J9,{initialValues:{newMessageText:""},onSubmit:function(e,a){r.sendMessage(n,e.newMessageText),t("67px"),a.setSubmitting(!1),a.resetForm()},children:function(e){var n=e.isSubmitting;return(0,I.jsxs)(A.l0,{className:U,children:[(0,I.jsx)(A.gN,{type:"text",name:"newMessageText",component:E.C,onHeightChange:i,validate:P,placeholder:"eng"===s.currentLanguage?"Type a message...":"ru"===s.currentLanguage&&"\u041d\u0430\u043f\u0438\u0448\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435...",defaultHeight:40,maxHeight:"200px"}),(0,I.jsxs)("button",{className:R+" button",type:"submit",disabled:n,children:["eng"===s.currentLanguage&&"Send"," ","ru"===s.currentLanguage&&"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c"]})]})}})})},W=t(5556),q=t(6871),J=t(6613),z=["isInit","initializeChat","cleanUpChat","setIsNewMessage","messages","sendMessage"],G=function(e){var n=e.isInit,t=e.initializeChat,u=e.cleanUpChat,o=e.setIsNewMessage,d=e.messages,l=e.sendMessage,g=(0,a.Z)(e,z),h=(0,v.useContext)(x.I),f="eng"===h.currentLanguage?"Messages | Feelanet":"ru"===h.currentLanguage&&"\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u044f | Feelanet";(0,v.useEffect)((function(){(0,J.J)()?h.setIsScrollbarActive(!0):h.setIsScrollbarActive(!1)})),(0,v.useEffect)((function(){document.title=f}),[h.currentLanguage]),(0,v.useEffect)((function(){return t(_),function(){u()}}),[]);var _=(0,q.UO)().userId,m=(0,v.useState)("67px"),p=(0,r.Z)(m,2),N=p[0],b=p[1],j=(0,v.useState)({observer:null,target:null}),M=(0,r.Z)(j,2),y=M[0],k=M[1];return n?n?(0,I.jsxs)("div",{className:s,children:[(0,I.jsx)(i.Z,{title:f}),(0,I.jsxs)("div",{className:c+" wrapNoPadding",children:[(0,I.jsx)(w,{recipientImage:g.recipientImage,recipientName:g.recipientName,dialogId:_}),(0,I.jsx)(O,{setIsNewMessage:o,messages:d,userImage:g.userImage,recipientImage:g.recipientImage,inputHeight:N,dialogId:_,getDialog:g.getDialog,observerRef:y,setObserverRef:k}),(0,I.jsx)(F,{sendMessage:l,dialogId:_,onInputHeightChange:function(e){b(e)}})]})]}):void 0:(0,I.jsx)("div",{className:s+" wrapNoPadding",children:(0,I.jsx)(W.Z,{})})},V=t(2190),$=t(7781),Q=t(1548),X=t(7030),Y={initializeChat:V.aT,cleanUpChat:V.fH,setIsNewMessage:V.IW,sendMessage:V.bG,getDialog:V.Yq},K=(0,$.qC)(Q.D,(0,M.$j)((function(e){return{isInit:(0,X.RU)(e),messages:(0,X.AZ)(e),userImage:(0,X.a8)(e),recipientImage:(0,X.Md)(e),recipientName:(0,X.Z6)(e)}}),Y))(G)},4759:function(e,n,t){t.d(n,{P:function(){return N},C:function(){return b}});var r=t(1413),a=t(5987),s="Inputs_inputWrap__bxhik",c="Inputs_inputWrap_withIcon__xxyLT",i="Inputs_inputWrap_dark__wb1gX",u="Inputs_input__6JgzO",o="Inputs_icon__v2Fgu",d="Inputs_input_error__N+OzZ",l="Inputs_textarea__K0ZBr",g="Inputs_textarea_dark__ibBbA",h="Inputs_checkboxWrap__AZQyn",f="Inputs_checkbox__gnsjA",_="Inputs_checkbox__label__G4bqt",m=t(2791),p=t(9029),v=t(9067),x=t(184),I=["form","field","options","onValueChange","children"],w=["form","field"],N=function(e){var n=e.form,t=e.field,l=e.options,g=e.onValueChange,w=(e.children,(0,a.Z)(e,I)),N=(0,m.useContext)(v.I);l&&l.inputMaxLength&&t.value.length>l.inputMaxLength&&(t.value=t.value.substr(0,l.inputMaxLength)),(0,m.useEffect)((function(){g&&g(t.value)}),[t.value]);var b,j="dark"===N.currentTheme?s+" "+i:s;switch(w.type){case"text":j=l&&l.icon?j+" "+c:j,b=l&&l.showErrors&&n.errors[t.name]?u+" "+d:u;break;case"checkbox":j=h,b=f;break;default:b=l&&l.showErrors&&n.errors[t.name]?u+" "+d:u}return(0,x.jsxs)("div",{className:j,children:[(0,x.jsx)("input",(0,r.Z)({style:{border:l&&l.border,padding:l&&l.padding},name:t.name,value:t.value,onChange:n.handleChange,className:b,checked:t.checked},w)),l&&l.icon&&(0,x.jsx)(p.O,{className:o,id:l.icon}),w.label&&(0,x.jsx)("span",{className:_,children:w.label})]})},b=function(e){var n=e.form,t=e.field,r=(0,a.Z)(e,w),s=(0,m.useContext)(v.I),c=m.createRef();(0,m.useEffect)((function(){n.values[t.name]||i()}),[n.values]);var i=function(){c.current.style.height="".concat(r.defaultHeight+2,"px")},u=(r.inputType,"dark"===s.currentTheme?l+" "+g:l);return(0,x.jsx)("textarea",{ref:c,style:{height:"".concat(r.defaultHeight,"px"),maxHeight:r.maxHeight},type:r.type,name:t.name,onChange:function(e){n.handleChange(e),function(e){c.current.style.height="".concat(r.defaultHeight+2,"px");var n="".concat(e.target.scrollHeight,"px");c.current.style.height=n,r.onHeightChange&&r.onHeightChange()}(e)},onFocus:function(){r.onFocus&&r.onFocus()},onBlur:function(){r.onBlur&&r.onBlur()},value:t.value,className:u,placeholder:r.placeholder})}},5556:function(e,n,t){t.d(n,{Z:function(){return i}});var r=t(695),a="Preloader_wrap__BkHvc",s="Preloader_gif__18c7L",c=t(184),i=function(e){return(0,c.jsx)("div",{className:a,children:(0,c.jsx)("img",{className:s,src:r})})}},1548:function(e,n,t){t.d(n,{D:function(){return u}});var r=t(1413),a=t(364),s=t(6871),c=t(7561),i=t(184),u=function(e){var n={getUserData:c.is};return(0,a.$j)((function(e){return{isAuth:e.auth.isAuth}}),n)((function(n){return n.isAuth?(0,i.jsx)(e,(0,r.Z)({},n)):(0,i.jsx)(s.Fg,{replace:!0,to:"/login"})}))}},7030:function(e,n,t){t.d(n,{ru:function(){return a},RU:function(){return s},oq:function(){return c},$U:function(){return i},AZ:function(){return u},a8:function(){return o},Z6:function(){return d},Md:function(){return l}});var r=t(6916),a=function(e){return e.chat.dialogsIsInit},s=function(e){return e.chat.chatIsInit},c=function(e){return e.chat.dialogsSearchTerm},i=(0,r.P1)((function(e){return e.chat.dialogs}),c,(function(e,n){return e.filter((function(e){return e.userName.includes(n)}))})),u=function(e){return e.chat.messages},o=function(e){return e.chat.userPhoto},d=function(e){return e.chat.recipientName},l=function(e){return e.chat.recipientPhoto}},6613:function(e,n,t){t.d(n,{J:function(){return r}});var r=function(){return document.body.clientWidth<window.innerWidth}},5689:function(e,n,t){t.d(n,{q9:function(){return r},sx:function(){return a},BS:function(){return s},Ei:function(){return c},oH:function(){return i},mQ:function(){return u}});var r=function(e,n){var t="Field is required";return"ru"===n&&(t="\u041e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043f\u043e\u043b\u0435"),e?void 0:t},a=function(e){return e?void 0:" "},s=function(e,n,t){var r=null;return e&&e.length>n&&(r="Must be ".concat(n," characters or less")),e&&e.length>n&&"ru"===t&&(r="\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u043b\u0438\u043d\u0430 \u0441\u0442\u0440\u043e\u043a\u0438 - ".concat(n," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")),r},c=function(e,n,t){var r=null;return e&&e.length<n&&(r="Must be ".concat(n," characters or less")),e&&e.length<n&&"ru"===t&&(r="\u041c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u0430\u044f \u0434\u043b\u0438\u043d\u0430 \u0441\u0442\u0440\u043e\u043a\u0438 - ".concat(n," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")),r},i=function(e,n){var t;return/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i.test(e)||(t="Invalid Email address","ru"===n&&(t="\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 Email \u0430\u0434\u0440\u0435\u0441")),t},u=function(e,n){var t;return 0===e.length||/^[A-Z0-9._%+-]+\.[A-Z0-9/._-]{2,1000}$/i.test(e)||(t="Invalid URL","ru"===n&&(t="\u041d\u0435\u043a\u043e\u0440\u0440\u0435\u043a\u0442\u043d\u044b\u0439 URL \u0430\u0434\u0440\u0435\u0441")),t}},4786:function(e,n,t){t.d(n,{H:function(){return r}});var r=function(e,n){var t=e.root,r=e.rootMargin,a=void 0===r?"0px":r,s=e.threshold;return new IntersectionObserver((function(e,t){e.forEach((function(e){e.isIntersecting&&(n(),t.unobserve(e.target))}))}),{root:t,rootMargin:a,threshold:void 0===s?.1:s})}},695:function(e,n,t){e.exports=t.p+"static/media/preloading.20a21d3c5d14bc614403.gif"}}]);
//# sourceMappingURL=747.76f5e613.chunk.js.map